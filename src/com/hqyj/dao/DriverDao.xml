<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hqyj.dao.DriverDao">

    <!-- 查询列表，支持根据名字模糊查询 -->
    <select id="getList" parameterType="driver" resultType="driver">
        select * from driver
        <where>
            <if test="name != null and name != ''">
                and name like '%${name}%'
            </if>
        </where>
    </select>

    <!-- 添加驾驶员，注意dno不是自增，是手动输入的驾驶证号 -->
	<!-- 1. 修改 insert 语句：增加所有新字段 -->
	<insert id="add" parameterType="driver">
	    insert into driver(
	        dno, name, idcard, sex, score, tel, money, backup, createtime
	    )
	    values(
	        #{dno}, #{name}, #{idcard}, #{sex}, #{score}, #{tel}, #{money}, #{backup}, now()
	    )
	</insert>

	<delete id="delete" parameterType="string">
        DELETE FROM driver WHERE dno = #{dno}
    </delete>
        <!-- 根据主键查询 -->
    <select id="getDriver" parameterType="string" resultType="driver">
        select * from driver where dno = #{dno}
    </select>
    
    <!-- 更新操作 -->
    <update id="update" parameterType="driver">
	    update driver set 
	        name = #{name},
	        idcard = #{idcard},
	        sex = #{sex},
	        score = #{score},
	        tel = #{tel},
	        money = #{money},
	        backup = #{backup}
	    where dno = #{dno}
	</update>
	
	<select id="getDriverByDno" parameterType="string" resultType="driver">
    SELECT * FROM driver WHERE dno = #{dno}
	</select>
	<update id="updateMoney" parameterType="driver">
	    UPDATE driver SET money = #{money} WHERE dno = #{dno}
	</update>
	    
</mapper>
